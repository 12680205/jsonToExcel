(function(b){var a=(function(){var j='<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><meta name=ProgId content=Excel.Sheet> <meta name=Generator content="Microsoft Excel 11"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body><table>${table}</table></body></html>';var i=function(n,o){console.log(n,o);var l="",m=[];if(o){l+="<thead>";for(var k in o){m.push(k);l+="<th>"+o[k]+"</th>"}l+="</thead>";l+="<tbody>";n.map(function(r,p){l+="<tr>";for(var q=0;q<m.length;q++){l+="<td>"+r[m[q]]+"</td>"}l+="</tr>"});l+="</tbody>";return j.replace("${table}",l)}n.map(function(r,p){l+="<tbody><tr>";for(var q in r){l+="<td>"+r[q]+"</td>"}l+="</tr></tbody>"});return j.replace("${table}",l)};var f=function(l,k){var m="";if(k){l.map(function(o){for(var n=0;n<k.length;n++){m+=o[k[n]]+","}m=m.slice(0,m.length-1);m+="\r\n"});return m}l.map(function(o){for(var n in o){m+=o[n]+","}m=m.slice(0,m.length-1);m+="\r\n"});return m};var d=function(k){return window.btoa(window.unescape(encodeURIComponent(k)))};var e=function(l,n,m){var k="data:application/vnd.ms-excel;base64,"+d(i(l,m));console.log(i(l,m));c(k,n)};var h=function(m,n,l){var k="data:application/csv;base64,"+d(f(m,l));console.log(k);c(k,n)};var c=function(n,o){if(window.navigator.msSaveBlob){var l=g(n);window.navigator.msSaveBlob(l,filename);return false}var m=document.createElement("a");if(window.URL.createObjectURL){var l=g(n);var k=window.URL.createObjectURL(l);m.href=k;m.download=o;m.click();return}if(m.download===""){m.href=n;m.download=o;m.click();return}};var g=function(m){var k=m.split(","),p=k[0].match(/:(.*?);/)[1],l=atob(k[1]),q=l.length,o=new Uint8Array(q);while(q--){o[q]=l.charCodeAt(q)}return new Blob([o],{type:p})};return{exportXLS:e,exportCSV:h}}());if(typeof define==="function"&&define.amd){define(function(){return a})}else{if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports){exports=module.exports=a}exports.JSONTOEXCEL=a}else{b.JSONTOEXCEL=a}}})(this);